# å¦‚ä½•å®æ—¶æŸ¥çœ‹Autowareçš„Laneletåœ°å›¾é€Ÿåº¦é™åˆ¶ - å¿«é€ŸæŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1ï¼šä½¿ç”¨ç›‘æ§è„šæœ¬ï¼ˆæ¨èï¼‰

**æœ€ç®€å•çš„æ–¹å¼ - ä¸€é”®æŸ¥çœ‹æ‰€æœ‰é€Ÿåº¦é™åˆ¶ä¿¡æ¯ï¼š**

```bash
./check_speed_limit.sh
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
======================================
  Autoware é€Ÿåº¦é™åˆ¶å®æ—¶ç›‘æ§
======================================

[1] å½“å‰æœ€å¤§é€Ÿåº¦é™åˆ¶
  æœ€å¤§é€Ÿåº¦é™åˆ¶: 15.0 m/s (54.0 km/h)
  æ¥æº: velocity_smoother

[2] å½“å‰è½¦é€Ÿ
  å½“å‰é€Ÿåº¦: 8.5 m/s (30.6 km/h)
  âœ“ é€Ÿåº¦æ­£å¸¸ (56% çš„é™é€Ÿ)

[3] å½“å‰è½¨è¿¹é€Ÿåº¦åˆ†å¸ƒ
   45 ä¸ªç‚¹: 0.00 m/s (0.0 km/h)
  120 ä¸ªç‚¹: 8.33 m/s (30.0 km/h)
   35 ä¸ªç‚¹: 13.89 m/s (50.0 km/h)

[4] åœæ­¢ç‚¹æ£€æŸ¥
  âœ“ æ£€æµ‹åˆ° 45 ä¸ªåœæ­¢ç‚¹

[5] Behavior Planningè·¯å¾„é€Ÿåº¦ï¼ˆæ¥è‡ªLaneletåœ°å›¾ï¼‰
  ç‚¹é€Ÿåº¦: 8.33 m/s (30.0 km/h)
  ç‚¹é€Ÿåº¦: 8.33 m/s (30.0 km/h)
  ç‚¹é€Ÿåº¦: 8.33 m/s (30.0 km/h)

[6] å¤–éƒ¨é€Ÿåº¦é™åˆ¶ï¼ˆå¦‚æœ‰ï¼‰
  âœ“ æ— å¤–éƒ¨é€Ÿåº¦é™åˆ¶
```

### æ–¹æ³•2ï¼šä½¿ç”¨ROSå‘½ä»¤æŸ¥çœ‹å½“å‰é€Ÿåº¦é™åˆ¶

```bash
# æŸ¥çœ‹å½“å‰åº”ç”¨çš„é€Ÿåº¦é™åˆ¶
ros2 topic echo /planning/scenario_planning/current_max_velocity

# åªçœ‹é€Ÿåº¦å€¼
ros2 topic echo /planning/scenario_planning/current_max_velocity --once | grep max_velocity
```

### æ–¹æ³•3ï¼šåœ¨RVizä¸­å¯è§†åŒ–æŸ¥çœ‹

1. å¯åŠ¨Autowareåï¼ŒRVizä¼šè‡ªåŠ¨æ˜¾ç¤º
2. åœ¨RVizçª—å£**å·¦ä¸Šè§’**å¯ä»¥çœ‹åˆ°ä»ªè¡¨ç›˜
3. **çº¢è‰²åœ†åœˆæ ‡å¿—**æ˜¾ç¤ºçš„å°±æ˜¯å½“å‰é€Ÿåº¦é™åˆ¶ï¼ˆå•ä½ï¼škm/hï¼‰
4. å½“è½¦é€Ÿæ¥è¿‘é™é€Ÿæ—¶ï¼Œåœ†åœˆä¼šå˜æˆæ©™è‰²/çº¢è‰²è­¦å‘Š

## ğŸ“Š å…³é”®ROSè¯é¢˜

| è¯é¢˜ | åŠŸèƒ½ | å‘½ä»¤ |
|-----|------|------|
| `/planning/scenario_planning/current_max_velocity` | **å½“å‰é€Ÿåº¦é™åˆ¶** | `ros2 topic echo /planning/scenario_planning/current_max_velocity` |
| `/planning/scenario_planning/trajectory` | è½¨è¿¹ç‚¹é€Ÿåº¦ | `ros2 topic echo /planning/scenario_planning/trajectory` |
| `/planning/scenario_planning/lane_driving/behavior_planning/path` | **åœ°å›¾åŸå§‹é€Ÿåº¦** | `ros2 topic echo /planning/scenario_planning/lane_driving/behavior_planning/path` |
| `/vehicle/status/velocity_status` | å®é™…è½¦é€Ÿ | `ros2 topic echo /vehicle/status/velocity_status` |

## ğŸ” å¸¸ç”¨æŸ¥è¯¢å‘½ä»¤

### æŸ¥çœ‹åœ°å›¾ä¸­å®šä¹‰çš„é€Ÿåº¦é™åˆ¶

```bash
# æŸ¥çœ‹behavior planningè¾“å‡ºçš„è·¯å¾„ï¼ˆåŒ…å«ä»laneletåœ°å›¾è¯»å–çš„é€Ÿåº¦ï¼‰
ros2 topic echo /planning/scenario_planning/lane_driving/behavior_planning/path --once | \
  grep "longitudinal_velocity_mps" | head -n 10
```

### ç»Ÿè®¡è½¨è¿¹ä¸­çš„é€Ÿåº¦åˆ†å¸ƒ

```bash
ros2 topic echo /planning/scenario_planning/trajectory --once | \
  grep "longitudinal_velocity_mps" | \
  awk '{print $2}' | sort -n | uniq -c
```

### æŒç»­ç›‘æ§é€Ÿåº¦é™åˆ¶å˜åŒ–

```bash
watch -n 0.5 "ros2 topic echo /planning/scenario_planning/current_max_velocity --once | grep 'max_velocity'"
```

### æ£€æŸ¥é€Ÿåº¦é™åˆ¶æ¥æº

```bash
# æŒ‰ä¼˜å…ˆçº§æ£€æŸ¥å„ä¸ªæ¥æº
echo "1. å¤–éƒ¨é€Ÿåº¦é™åˆ¶ï¼š"
ros2 topic echo /planning/scenario_planning/max_velocity --once | grep max_velocity

echo "2. å½“å‰åº”ç”¨çš„é€Ÿåº¦é™åˆ¶ï¼š"
ros2 topic echo /planning/scenario_planning/current_max_velocity --once | grep max_velocity

echo "3. è½¦è¾†å‘½ä»¤ç½‘å…³é™åˆ¶ï¼š"
ros2 param get /control/vehicle_cmd_gate nominal.vel_lim

echo "4. Planningæ¨¡å—æœ€å¤§é€Ÿåº¦ï¼š"
ros2 param get /planning/scenario_planning/lane_driving/motion_planning/path_optimizer max_vel 2>/dev/null || echo "å‚æ•°ä¸å­˜åœ¨"
```

## ğŸ’¡ é€Ÿåº¦å€¼è½¬æ¢

Autowareå†…éƒ¨ä½¿ç”¨ **m/s**ï¼Œåœ°å›¾ä¸­å®šä¹‰ä½¿ç”¨ **km/h**ï¼š

| m/s | km/h | è¯´æ˜ |
|-----|------|------|
| 4.17 | 15 | ä½é€ŸåŒºåŸŸ |
| 8.33 | 30 | åŸå¸‚é“è·¯ |
| 13.89 | 50 | ä¸»å¹²é“ |
| 22.22 | 80 | å¿«é€Ÿè·¯ |

**å¿«é€Ÿè½¬æ¢å…¬å¼ï¼š**
- m/s â†’ km/h: ä¹˜ä»¥ 3.6
- km/h â†’ m/s: é™¤ä»¥ 3.6

## ğŸ¯ å®ç”¨æŠ€å·§

### 1. å¿«é€Ÿæ£€æŸ¥å½“å‰é™é€Ÿå’Œè½¦é€Ÿ

```bash
echo "é™é€Ÿ: $(ros2 topic echo /planning/scenario_planning/current_max_velocity --once 2>/dev/null | grep max_velocity | awk '{print $2 * 3.6}') km/h"
echo "è½¦é€Ÿ: $(ros2 topic echo /vehicle/status/velocity_status --once 2>/dev/null | grep longitudinal_velocity | awk '{print $2 * 3.6}') km/h"
```

### 2. æ£€æŸ¥æ˜¯å¦æœ‰åœæ­¢ç‚¹

```bash
STOP_POINTS=$(ros2 topic echo /planning/scenario_planning/trajectory --once 2>/dev/null | grep "longitudinal_velocity_mps: 0.0" | wc -l)
echo "è½¨è¿¹ä¸­æœ‰ $STOP_POINTS ä¸ªåœæ­¢ç‚¹"
```

### 3. æŸ¥çœ‹åœ°å›¾æ–‡ä»¶ä¸­çš„é€Ÿåº¦é™åˆ¶å®šä¹‰

```bash
# æ‰¾åˆ°ä½ çš„åœ°å›¾æ–‡ä»¶è·¯å¾„åæ‰§è¡Œ
grep "speed_limit" /path/to/your_map.osm | grep -o 'v="[0-9.]*"' | sort | uniq -c
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šè¯é¢˜æ²¡æœ‰æ•°æ®
```bash
# æ£€æŸ¥Autowareæ˜¯å¦æ­£å¸¸è¿è¡Œ
ros2 topic list | grep planning

# æ£€æŸ¥è¯é¢˜å‘å¸ƒé¢‘ç‡
ros2 topic hz /planning/scenario_planning/current_max_velocity
```

### é—®é¢˜2ï¼šé€Ÿåº¦é™åˆ¶ä¸º0
å¯èƒ½åŸå› ï¼š
- Laneletåœ°å›¾ä¸­æœªè®¾ç½®speed_limitæ ‡ç­¾
- traffic_rulesæœªæ­£ç¡®åŠ è½½
- æ£€æŸ¥åœ°å›¾æ–‡ä»¶ä¸­æ˜¯å¦æœ‰speed_limitå®šä¹‰

### é—®é¢˜3ï¼šè½¦è¾†ä¸éµå®ˆåœ°å›¾é™é€Ÿ
æ£€æŸ¥ä¼˜å…ˆçº§æ›´é«˜çš„é™åˆ¶ï¼š
1. å¤–éƒ¨é€Ÿåº¦é™åˆ¶ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. vehicle_cmd_gateçš„vel_limå‚æ•°
3. planningæ¨¡å—çš„max_velå‚æ•°

## ğŸ“– è¯¦ç»†æ–‡æ¡£

å®Œæ•´çš„æŠ€æœ¯ç»†èŠ‚å’Œä»£ç ä½ç½®ï¼Œè¯·å‚è€ƒï¼š
- `laneletåœ°å›¾é€Ÿåº¦é™åˆ¶å‚æ•°è¯´æ˜.md` - å®Œæ•´æŠ€æœ¯æ–‡æ¡£

## ğŸ› ï¸ å·¥å…·ä½ç½®

- ç›‘æ§è„šæœ¬ï¼š`./check_speed_limit.sh`
- RVizé…ç½®ï¼š`src/launcher/autoware_launch/autoware_launch/rviz/autoware.rviz`
- é€Ÿåº¦æ˜¾ç¤ºæ’ä»¶ï¼š`src/universe/autoware_universe/visualization/autoware_overlay_rviz_plugin/`

---

**æç¤ºï¼š** åœ¨Autowareè¿è¡Œæ—¶æ‰§è¡Œä¸Šè¿°å‘½ä»¤æ‰èƒ½çœ‹åˆ°æ•°æ®ã€‚å¦‚æœç³»ç»Ÿæœªè¿è¡Œï¼Œè¯é¢˜ä¸ä¼šæœ‰æ•°æ®è¾“å‡ºã€‚

