# Autoware Planningæ¶æ„å¯è§†åŒ–å›¾è¡¨

## 1. æ•´ä½“æ¶æ„å±‚æ¬¡å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Autoware Planning Stack                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  autoware_core/planning       â”‚   â”‚ autoware_universe/planningâ”‚
    â”‚  (åŸºç¡€å±‚ - Foundation)        â”‚   â”‚  (åº”ç”¨å±‚ - Application)   â”‚
    â”‚                               â”‚   â”‚                           â”‚
    â”‚  â€¢ æ ¸å¿ƒæ¥å£å’Œæ•°æ®ç»“æ„          â”‚   â”‚  â€¢ å¤æ‚åœºæ™¯å¤„ç†            â”‚
    â”‚  â€¢ åŸºç¡€ç®—æ³•å®ç°               â”‚   â”‚  â€¢ è¡Œä¸ºå†³ç­–               â”‚
    â”‚  â€¢ é€šç”¨å·¥å…·åº“                 â”‚   â”‚  â€¢ é«˜çº§è§„åˆ’æ¨¡å—            â”‚
    â”‚  â€¢ ç¨³å®šå¯é                    â”‚   â”‚  â€¢ å¯æ’æ‹”æ¨¡å—             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                               â”‚
                    â”‚      æä¾›åŸºç¡€ç»„ä»¶              â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                            ä¾èµ–Coreç»„ä»¶
```

## 2. Core Planning æ¨¡å—å…³ç³»å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Planning Input Sources      â”‚
                    â”‚  (å¤–éƒ¨è¾“å…¥)                   â”‚
                    â”‚  â€¢ /map/vector_map           â”‚
                    â”‚  â€¢ /planning/mission_planning/route â”‚
                    â”‚  â€¢ /localization/kinematic_state    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  autoware_mission_planner â”‚
                â”‚  (å…¨å±€è·¯å¾„è§„åˆ’)            â”‚
                â”‚  â€¢ èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯ç”±        â”‚
                â”‚  â€¢ Laneletåºåˆ—ç”Ÿæˆ        â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  autoware_route_handler   â”‚â—„â”€â”€â”€â”€â”
                â”‚  (è·¯ç”±ç®¡ç†æ ¸å¿ƒ)            â”‚     â”‚
                â”‚  â€¢ è·¯ç”±ä¿¡æ¯å­˜å‚¨            â”‚     â”‚
                â”‚  â€¢ LaneletæŸ¥è¯¢æœåŠ¡        â”‚     â”‚ æ‰€æœ‰å…¶ä»–æ¨¡å—
                â”‚  â€¢ å‰åè½¦é“å…³ç³»æŸ¥è¯¢        â”‚     â”‚ éƒ½éœ€è¦ä¾èµ–
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ route_handler
                              â”‚                   â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
                â”‚  autoware_path_generator  â”‚â”€â”€â”€â”€â”€â”˜
                â”‚  (åŸºç¡€è·¯å¾„ç”Ÿæˆ)            â”‚
                â”‚  â€¢ è·Ÿéšè·¯ç”±ç”Ÿæˆè·¯å¾„        â”‚
                â”‚  â€¢ è½¬å‘ç¯æ§åˆ¶              â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Behavior       â”‚  â”‚ Motion           â”‚  â”‚ Velocity        â”‚
â”‚ Velocity       â”‚  â”‚ Velocity         â”‚  â”‚ Smoother        â”‚
â”‚ Planner        â”‚  â”‚ Planner          â”‚  â”‚                 â”‚
â”‚ (Common)       â”‚  â”‚ (Common)         â”‚  â”‚ â€¢ é€Ÿåº¦å¹³æ»‘      â”‚
â”‚                â”‚  â”‚                  â”‚  â”‚ â€¢ åŠ åŠ é€Ÿåº¦çº¦æŸ  â”‚
â”‚ â€¢ åœæ­¢çº¿       â”‚  â”‚ â€¢ éšœç¢ç‰©åœæ­¢     â”‚  â”‚ â€¢ æ¨ªå‘åŠ é€Ÿåº¦    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Planning Output    â”‚
                    â”‚ /planning/.../trajectory â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. Universe Planning æ‰©å±•æ¨¡å—æ ‘

```
autoware_universe/planning/
â”‚
â”œâ”€â”€â”€ ğŸ­ åœºæ™¯æ§åˆ¶å±‚
â”‚    â””â”€â”€ autoware_scenario_selector
â”‚         â”œâ”€â†’ LANE_DRIVING â”€â”€â”€â”€â”€â”
â”‚         â””â”€â†’ PARKING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â†’ é€‰æ‹©ä¸åŒçš„planning pipeline
â”‚                                 â”‚
â”œâ”€â”€â”€ ğŸš— è¡Œä¸ºå†³ç­–å±‚ (Lane Driving)  â”‚
â”‚    â”‚                            â”‚
â”‚    â”œâ”€â”€ behavior_path_planner â—„â”€â”€â”˜
â”‚    â”‚   â”œâ”€â”€ ğŸ“ åœºæ™¯æ¨¡å—:
â”‚    â”‚   â”‚   â”œâ”€ start_planner_module        (èµ·æ­¥è§„åˆ’)
â”‚    â”‚   â”‚   â”œâ”€ goal_planner_module         (ç›®æ ‡/æ³Šè½¦è§„åˆ’)
â”‚    â”‚   â”‚   â”œâ”€ lane_change_module          (æ¢é“)
â”‚    â”‚   â”‚   â”œâ”€ side_shift_module           (ä¾§ç§»)
â”‚    â”‚   â”‚   â”œâ”€ static_obstacle_avoidance   (é™æ€é¿éšœ)
â”‚    â”‚   â”‚   â”œâ”€ dynamic_obstacle_avoidance  (åŠ¨æ€é¿éšœ)
â”‚    â”‚   â”‚   â””â”€ sampling_planner_module     (é‡‡æ ·è§„åˆ’)
â”‚    â”‚   â”‚
â”‚    â”‚   â””â”€â”€ ä¾èµ–Core: route_handler, planning_factor_interface
â”‚    â”‚
â”‚    â””â”€â”€ behavior_velocity_planner (æ‰©å±•ç‰ˆ)
â”‚        â”œâ”€â”€ ğŸ“Œ äº¤é€šè§„åˆ™æ¨¡å—:
â”‚        â”‚   â”œâ”€ traffic_light_module        (äº¤é€šç¯)
â”‚        â”‚   â”œâ”€ crosswalk_module            (äººè¡Œæ¨ªé“)
â”‚        â”‚   â”œâ”€ intersection_module         (è·¯å£)
â”‚        â”‚   â”œâ”€ blind_spot_module           (ç›²åŒº)
â”‚        â”‚   â”œâ”€ stop_line_module            (åœæ­¢çº¿ - æ¥è‡ªCore)
â”‚        â”‚   â”œâ”€ detection_area_module       (æ£€æµ‹åŒºåŸŸ)
â”‚        â”‚   â”œâ”€ no_stopping_area_module     (ç¦åœåŒº)
â”‚        â”‚   â”œâ”€ virtual_traffic_light       (è™šæ‹Ÿäº¤é€šç¯)
â”‚        â”‚   â”œâ”€ speed_bump_module           (å‡é€Ÿå¸¦)
â”‚        â”‚   â”œâ”€ run_out_module              (å†²å‡ºæ£€æµ‹)
â”‚        â”‚   â””â”€ occlusion_spot_module       (é®æŒ¡ç‚¹)
â”‚        â”‚
â”‚        â””â”€â”€ ä¾èµ–Core: velocity_smoother, route_handler
â”‚
â”œâ”€â”€â”€ ğŸ¯ è¿åŠ¨è§„åˆ’å±‚
â”‚    â”‚
â”‚    â”œâ”€â”€ motion_velocity_planner (æ‰©å±•ç‰ˆ)
â”‚    â”‚   â”œâ”€â”€ ğŸš§ éšœç¢ç‰©å¤„ç†:
â”‚    â”‚   â”‚   â”œâ”€ obstacle_cruise_module      (éšœç¢ç‰©å·¡èˆª)
â”‚    â”‚   â”‚   â”œâ”€ obstacle_slow_down_module   (éšœç¢ç‰©å‡é€Ÿ)
â”‚    â”‚   â”‚   â”œâ”€ obstacle_stop_module        (éšœç¢ç‰©åœæ­¢ - æ¥è‡ªCore)
â”‚    â”‚   â”‚   â”œâ”€ dynamic_obstacle_stop       (åŠ¨æ€éšœç¢ç‰©)
â”‚    â”‚   â”‚   â”œâ”€ obstacle_velocity_limiter   (é€Ÿåº¦é™åˆ¶)
â”‚    â”‚   â”‚   â””â”€ out_of_lane_module          (è½¦é“å¤–æ£€æµ‹)
â”‚    â”‚   â”‚
â”‚    â”‚   â””â”€â”€ ä¾èµ–Core: motion_velocity_planner_common
â”‚    â”‚
â”‚    â”œâ”€â”€ sampling_based_planner/
â”‚    â”‚   â””â”€â”€ autoware_path_sampler          (è·¯å¾„é‡‡æ ·)
â”‚    â”‚        â””â”€â”€ ä¾èµ–Core: vehicle_info_utils
â”‚    â”‚
â”‚    â”œâ”€â”€ autoware_path_optimizer            (è·¯å¾„ä¼˜åŒ–)
â”‚    â”‚   â””â”€â”€ åŠŸèƒ½: é¿éšœä¼˜åŒ–ã€è·¯å¾„å¹³æ»‘
â”‚    â”‚
â”‚    â””â”€â”€ autoware_path_smoother             (è·¯å¾„å¹³æ»‘)
â”‚        â””â”€â”€ åŠŸèƒ½: å¼¹æ€§å¸¦å¹³æ»‘
â”‚
â”œâ”€â”€â”€ ğŸ…¿ï¸ åœè½¦è§„åˆ’å±‚ (Parking)
â”‚    â”‚
â”‚    â””â”€â”€ autoware_freespace_planner
â”‚         â”œâ”€â”€ ğŸ“ ç®—æ³•:
â”‚         â”‚   â”œâ”€ A* / Hybrid A*
â”‚         â”‚   â”œâ”€ RRT*
â”‚         â”‚   â””â”€ Reed-Sheppæ›²çº¿
â”‚         â”‚
â”‚         â””â”€â”€ ä¾èµ–Core: route_handler, vehicle_info_utils
â”‚
â”œâ”€â”€â”€ ğŸ” è¾…åŠ©åŠŸèƒ½å±‚
â”‚    â”‚
â”‚    â”œâ”€â”€ autoware_obstacle_cruise_planner   (è‡ªé€‚åº”å·¡èˆª)
â”‚    â”œâ”€â”€ autoware_surround_obstacle_checker (å‘¨è¾¹éšœç¢ç‰©æ£€æŸ¥)
â”‚    â”œâ”€â”€ autoware_planning_validator        (è½¨è¿¹éªŒè¯)
â”‚    â”œâ”€â”€ autoware_costmap_generator         (ä»£ä»·åœ°å›¾)
â”‚    â”œâ”€â”€ autoware_external_velocity_limit_selector (å¤–éƒ¨é€Ÿåº¦é™åˆ¶)
â”‚    â””â”€â”€ autoware_remaining_distance_time_calculator (å‰©ä½™è·ç¦»æ—¶é—´)
â”‚
â””â”€â”€â”€ ğŸ”§ å·¥å…·å’Œæ¥å£
     â””â”€â”€ autoware_rtc_interface             (RTCæ¥å£ - è¯·æ±‚æ§åˆ¶)
```

## 4. æ•°æ®æµå‘å›¾

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   å¤–éƒ¨ä¼ æ„Ÿå™¨å’Œå®šä½    â”‚
                        â”‚  â€¢ Map, Localization â”‚
                        â”‚  â€¢ Perception        â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Mission Planner     â”‚
                        â”‚  (Core)              â”‚
                        â”‚  å…¨å±€è·¯ç”±è§„åˆ’        â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚ LaneletRoute
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Route Handler       â”‚
                        â”‚  (Core - æ ¸å¿ƒä¾èµ–)   â”‚
                        â”‚  è·¯ç”±ç®¡ç†æœåŠ¡         â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                                   â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Scenario Selector   â”‚         â”‚  Freespace Planner        â”‚
      â”‚  (Universe)          â”‚         â”‚  (Universe - Parking)     â”‚
      â”‚  åœºæ™¯é€‰æ‹©            â”‚         â”‚  åœè½¦åœºè§„åˆ’               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
    â”‚  Lane Driving Pipeline  â”‚                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                 â”‚                                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚  Behavior Path Planner (Universe)     â”‚       â”‚
    â”‚  â€¢ æ¢é“ã€é¿éšœç­‰è¡Œä¸ºå†³ç­–                â”‚       â”‚
    â”‚  â€¢ ä½¿ç”¨Coreçš„route_handler            â”‚       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                 â”‚ Path                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚  Behavior Velocity Planner            â”‚       â”‚
    â”‚  (Core + Universeæ··åˆ)                â”‚       â”‚
    â”‚  â€¢ äº¤é€šè§„åˆ™é€Ÿåº¦è°ƒæ•´                    â”‚       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                 â”‚ Path with Velocity               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚  Motion Velocity Planner              â”‚       â”‚
    â”‚  (Core + Universeæ··åˆ)                â”‚       â”‚
    â”‚  â€¢ éšœç¢ç‰©é€Ÿåº¦è§„åˆ’                      â”‚       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                 â”‚ Trajectory (rough)               â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Velocity Smoother (Core)   â”‚
                  â”‚  æœ€ç»ˆé€Ÿåº¦å¹³æ»‘               â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ Trajectory (smoothed)
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Planning Validator         â”‚
                  â”‚  (Universe)                 â”‚
                  â”‚  è½¨è¿¹åˆæ³•æ€§æ£€æŸ¥             â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  /planning/scenario_planningâ”‚
                  â”‚         /trajectory         â”‚
                  â”‚  (æœ€ç»ˆè¾“å‡ºç»™æ§åˆ¶æ¨¡å—)       â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. æ¨¡å—å¯ç”¨/ç¦ç”¨é…ç½®å›¾

```
default_preset.yaml (é…ç½®å…¥å£)
â”‚
â”œâ”€ launch_avoidance_module: true/false
â”‚   â””â”€â†’ behavior_path_planner
â”‚       â””â”€â†’ static_obstacle_avoidance_module âœ“/âœ—
â”‚
â”œâ”€ launch_lane_change_right_module: true/false
â”‚   â””â”€â†’ behavior_path_planner
â”‚       â””â”€â†’ lane_change_right_module âœ“/âœ—
â”‚
â”œâ”€ launch_traffic_light_module: true/false
â”‚   â””â”€â†’ behavior_velocity_planner
â”‚       â””â”€â†’ traffic_light_module âœ“/âœ—
â”‚
â”œâ”€ launch_crosswalk_module: true/false
â”‚   â””â”€â†’ behavior_velocity_planner
â”‚       â””â”€â†’ crosswalk_module âœ“/âœ—
â”‚
â”œâ”€ launch_intersection_module: true/false
â”‚   â””â”€â†’ behavior_velocity_planner
â”‚       â””â”€â†’ intersection_module âœ“/âœ—
â”‚
â””â”€ motion_stop_planner_type: "obstacle_cruise_planner"
    â””â”€â†’ motion_velocity_planner
        â”œâ”€â†’ obstacle_cruise_planner (if selected) âœ“
        â””â”€â†’ obstacle_stop_planner (alternative) âœ—

AGVå®¤å†…åº”ç”¨æ¨èé…ç½®:
âœ“ ä¿æŒå¯ç”¨: static_obstacle_avoidance, side_shift, freespace_planner
âœ— å»ºè®®ç¦ç”¨: traffic_light, crosswalk, intersection, lane_change
```

## 6. AGVå®šåˆ¶æ¶æ„å»ºè®®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AGV Planning Stack                     â”‚
â”‚                  (åŸºäºAutowareå®šåˆ¶)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Core Modules   â”‚ â”‚ Selected    â”‚ â”‚ Custom         â”‚
â”‚ (å¿…é¡»ä¿ç•™)      â”‚ â”‚ Universe    â”‚ â”‚ AGV Modules   â”‚
â”‚                â”‚ â”‚ Modules     â”‚ â”‚ (è‡ªå®šä¹‰)       â”‚
â”‚ â€¢ mission_     â”‚ â”‚             â”‚ â”‚                â”‚
â”‚   planner      â”‚ â”‚ â€¢ behavior_ â”‚ â”‚ â€¢ agv_specific_â”‚
â”‚ â€¢ route_       â”‚ â”‚   path_     â”‚ â”‚   planner      â”‚
â”‚   handler      â”‚ â”‚   planner   â”‚ â”‚ â€¢ warehouse_   â”‚
â”‚ â€¢ velocity_    â”‚ â”‚   (ç®€åŒ–ç‰ˆ)  â”‚ â”‚   navigation   â”‚
â”‚   smoother     â”‚ â”‚ â€¢ freespace_â”‚ â”‚ â€¢ pallet_      â”‚
â”‚ â€¢ planning_    â”‚ â”‚   planner   â”‚ â”‚   approach     â”‚
â”‚   factor_      â”‚ â”‚ â€¢ obstacle_ â”‚ â”‚                â”‚
â”‚   interface    â”‚ â”‚   stop      â”‚ â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Common Dependencies  â”‚
              â”‚  â€¢ vehicle_info_utils â”‚
              â”‚  â€¢ motion_utils       â”‚
              â”‚  â€¢ route_handler      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. ç¼–è¯‘ä¾èµ–å…³ç³»å›¾

```
ç¼–è¯‘é¡ºåº (å¿…é¡»æŒ‰æ­¤é¡ºåº):

Level 1: CoreåŸºç¡€ç»„ä»¶
  â”œâ”€ autoware_vehicle_info_utils
  â”œâ”€ autoware_motion_utils
  â”œâ”€ autoware_planning_msgs
  â””â”€ autoware_internal_planning_msgs
          â”‚
          â–¼
Level 2: Core PlanningåŸºç¡€
  â”œâ”€ autoware_route_handler â—„â”€â”€â”€â”€â”€â”€â”€â” (æ ¸å¿ƒä¾èµ–)
  â”œâ”€ autoware_planning_factor_interface
  â”œâ”€ autoware_velocity_smoother      â”‚
  â””â”€ autoware_mission_planner        â”‚
          â”‚                          â”‚
          â–¼                          â”‚
Level 3: Universe Planningæ‰©å±•       â”‚
  â”œâ”€ behavior_path_planner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”œâ”€ behavior_velocity_planner â”€â”€â”€â”€â”€â”€â”˜
  â”œâ”€ motion_velocity_planner â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”œâ”€ freespace_planner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â””â”€ scenario_selector â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¼–è¯‘å‘½ä»¤ç¤ºä¾‹:
  # å…ˆç¼–è¯‘Core
  colcon build --packages-up-to autoware_route_handler
  
  # å†ç¼–è¯‘Universe (è‡ªåŠ¨å¤„ç†ä¾èµ–)
  colcon build --packages-select autoware_behavior_path_planner
```

## 8. è°ƒè¯•å’Œç›‘æ§æ¶æ„

```
è°ƒè¯•å·¥å…·æ ˆ:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         RViz2 å¯è§†åŒ–                     â”‚
â”‚  â€¢ Planning Markers                     â”‚
â”‚  â€¢ Debug Trajectory                     â”‚
â”‚  â€¢ Virtual Walls                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Planning Debug Topics               â”‚
â”‚  /planning/.../debug/*                  â”‚
â”‚  â€¢ stop_reasons                         â”‚
â”‚  â€¢ processing_time                      â”‚
â”‚  â€¢ planning_factors                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Planning Diagnostics                â”‚
â”‚  /diagnostics                           â”‚
â”‚  â€¢ Module Status                        â”‚
â”‚  â€¢ Performance Metrics                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ROS2 Tools                         â”‚
â”‚  â€¢ ros2 topic echo                      â”‚
â”‚  â€¢ ros2 param get/set                   â”‚
â”‚  â€¢ ros2 node info                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä½¿ç”¨å»ºè®®

### 1. æŸ¥çœ‹å®æ—¶æ¨¡å—çŠ¶æ€
```bash
# æŸ¥çœ‹æ‰€æœ‰planningèŠ‚ç‚¹
ros2 node list | grep planning

# æŸ¥çœ‹behavior_path_plannerçŠ¶æ€
ros2 topic echo /planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/debug/stop_reason
```

### 2. åˆ†ææ€§èƒ½ç“¶é¢ˆ
```bash
# æŸ¥çœ‹å„æ¨¡å—å¤„ç†æ—¶é—´
ros2 topic echo /planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/debug/processing_time

# ä½¿ç”¨ros2 bagè®°å½•å¹¶åˆ†æ
ros2 bag record /planning/.../debug/processing_time
```

### 3. è‡ªå®šä¹‰æ¨¡å—é›†æˆ
å‚è€ƒUniverseçš„æ’ä»¶æœºåˆ¶ï¼Œåœ¨behavior_path_planneræˆ–behavior_velocity_plannerä¸­æ·»åŠ è‡ªå®šä¹‰æ¨¡å—ã€‚

---

**æç¤º**: 
- ä½¿ç”¨ `rqt_graph` å¯ä»¥å¯è§†åŒ–èŠ‚ç‚¹å’Œè¯é¢˜è¿æ¥
- ä½¿ç”¨ `ros2 run tf2_tools view_frames` æŸ¥çœ‹åæ ‡å˜æ¢å…³ç³»
- åœ¨RViz2ä¸­å¯ç”¨Planningç›¸å…³çš„Markerå¯ä»¥ç›´è§‚çœ‹åˆ°è§„åˆ’è¿‡ç¨‹

